{"path":"P6 - Information/_handouts/Lecture 6 (Linear Control).pdf","text":"Part IB Paper 6: Information Engineering LINEAR SYSTEMS AND CONTROL Ioannis Lestas HANDOUT 6 “Feedback stability and the Nyquist diagram” If L(s) is stable (either marginally or asymptotically) , then: ℜ ℑ L(jω) −1 =⇒ L(s) Summary The Nyquist diagram of a feedback system is a plot of the frequency response of the return ratio, with the imaginary part ℑ (L(jω)) plotted against the real part ℜ (L(jω)) on an Argand diagram (that is, like the Bode diagram, it is a plot of an open-loop frequency response). The Nyquist stability criterion states that, if the open-loop system is asymptotically stable (i.e. the return ratio L(s) has all its poles in the LHP) and the Nyquist diagram of L(jω) does not enclose the point “−1”, then the closed-loop system will be asymptotically stable (i.e. the closed-loop transfer function L(s)/( 1 + L(s)) will have all its poles in the LHP) The real power of the Nyquist stability criterion is that it allows you to determine of the stability of the closed-loop system from the behaviour of the open-loop Nyquist diagram. This is important from a design point of view, as it relatively easy to see how changing K(s) aﬀects L(s) = H(s)G(s)K(s), but diﬃcult to see how changing K(s) aﬀects L(s)/(1 + L(s)) directly, for example. In addition, the Nyquist diagram also allows more detailed information about the behaviour of the closed-loop system to be inferred. For example Gain and phase margins measure how close the Nyquist locus gets to −1 (and hence how close the closed loop system is to instability). 2 Contents 6 Feedback stability and the Nyquist diagram 1 6.1 The Nyquist Diagram . . . . . . . . . . . . . . . . . . . . . . 4 6.1.1 Sketching Nyquist diagrams . . . . . . . . . . . . . . . 7 6.2 Feedback stability . . . . . . . . . . . . . . . . . . . . . . . . 8 6.2.1 Signiﬁcance of the point “−1” . . . . . . . . . . . . . . 9 6.2.2 Example: . . . . . . . . . . . . . . . . . . . . . . . . . 9 6.3 Nyquist Stability Theorem (informal version) . . . . . . . . . . 12 6.4 Gain and Phase Margins . . . . . . . . . . . . . . . . . . . . . 13 6.4.1 Gain and phase margins from the Bode plot . . . . . . 14 6.5 Performance of feedback systems . . . . . . . . . . . . . . . . 15 6.5.1 Open and closed-loop frequency response . . . . . . . . 16 6.6 The Nyquist stability theorem (for asymptotically stable L(s)) 19 6.6.1 Notes on the Nyquist Stability Theorem: . . . . . . . . 20 3 6.1 The Nyquist Diagram The Nyquist diagram of a system G(s) is a plot of the frequency response G(jω) on an Argand diagram. That is: it is a plot of ℑ(G(jω)) vs ℜ(G(jω)). ℜ (G(jω)) ℑ (G(jω)) The Nyquist locus ̸ The Nyquist diagram of a transfer function G(s) is a plot of the fre- quency response G(jω) but with diﬀerent quan- tities on the x and y axis relative to a Bode plot. In particular, it is a plot of G(jω) on an Argand diagram, i.e. a plot of the real vs the imaginary part of G(jω). As with the case of Bode plots, on a Nyquist diagram we illustrate the behaviour of G(jω) as ω → 0 and as ω → ∞. It is convenient to consider the magnitude and phase of G(jω) in these regimes in order to draw the diagram . 4 Time Delay: The Nyquist diagram of a system with transfer function e−sT , i.e. a de- lay T , is a circle with centre the origin and ra- dius 1. Note that the phase of e−jωT tends to −∞ as ω → ∞. A system with transfer function 1/(1 + sT ) is referred to as a ﬁrst- order lag. The Nyquist diagram of such a sys- tem is illustrated on the left. It can be shown that this is part of a cir- cle centred at the point 0.5 with radius 0.5. 5 Time Delay with Lag and Integrator: When the transfer func- tion has a pole at s = 0 then |G(jω)| → ∞ as ω → 0. In order to determine in what direction G(jω) tends to ∞ we do a Taylor ex- pansion around ω = 0 and consider the real and imaginary parts of G(jω). In the example on the left we see that as ω → 0 the real part is con- stant and the imagi- nary part tends to −∞. There is therefore a ver- tical asymptote as illus- trated in the diagram. 6 Second-order lag: 7 6.2 Feedback stability G(s)K(s)Σ +¯r(s) ¯e(s) ¯y(s) − ≡ L(s)Σ +¯r(s) ¯e(s) ¯y(s) − Closed-loop poles ≡ poles of G(s)K(s) The remainder of this handout will focus on the Nyquist Stability Theorem. This is a very important result in control engineering that facilitates control system design. Its key feature is that allows to deduce the stability of the closed- loop system from the frequency responce of the return ratio L(jω), i.e. from open-loop properties. In the next few pages we will discuss the intuition behind the theorem, and state ﬁrst an informal version of the theorem; i.e. a simpler statement that holds for the systems we will come across in this course. Towards the end of the handout we will state also the full version of the theo- rem. It should be noted that we will not provide the full proof of the Nyquist Stability Theorem as this is quite involved and is outside the scope of this course. 8 6.2.1 Signiﬁcance of the point “−1” If the Nyquist locus passes through the point “−1”, i.e. if L(jω1) = −1 for some ω1 then the closed-loop frequency response L(jω)/( 1 + L(jω)) becomes inﬁnite at that frequency, ie L(jω1)/( 1 + L(jω1)) → ∞ This is not a good thing! In this case, if e(t) = cos(ω1t) then in steady-state we have y(t) = |L(jω1)| cos (ω1t + ̸ In the example on the left we will investi- gate the position of the closed-loop poles, and hence the stability properties of the closed- loop system, as param- eter k varies. In each case we will also plot the Nyquist diagram of L(jω) and consider its shape relative to the point −1. 9 k = 1 10 k = 0.8 11 6.3 Nyquist Stability Theorem (informal version) We can now give an informal statement of Nyquist’s stability theorem: “If a feedback system has an asymptotically stable return ratio L(s), then the feedback system is also asymptotically stable if the Nyquist diagram of L(jω) leaves the point −1 + j0 on its left”. This is unambiguous in most cases, and usually still works if L(s) has poles at the origin or is unstable. For completeness, a full statement of this theorem will be given later. Deﬁnition: We say that the feedback system (or closed-loop system) is asymptotically stable if the closed-loop transfer function L(s) 12 6.4 Gain and Phase Margins L(jω) encirling or going through the −1 point is clearly bad, leading to the closed-loop not being asymptotically stable. However, L(jω) coming close to −1 without encircling it is also undesirable, for two reasons: It implies that a closed-loop pole will be close to the imaginary axis and that the closed-loop system will be oscillatory. If G(s) is the transfer function of an inaccurate model, then the “true” Nyquist diagram might actually encircle −1. Gain and phase margins are widely used measures of how close the return ration L(jω) gets to −1. The gain margin measures how much the gain of the return ratio can be increased before the closed-loop system becomes unstable. The phase margin measures how much phase lag can be added to the return ratio before the closed-loop system becomes unstable. ℜ ℑ −1 −α θ L(jω) Gain Margin = 1 The diagram on the left illustrates how the gain margin and phase mar- gin of a feedback system can be deduced from the Nyquist diagram of its return ratio L(s). 13 6.4.1 Gain and phase margins from the Bode plot ̸ The diagram on the left illustrates how the gain margin and phase margin of a feedback system can be deduced also from the Bode plot of its return ratio L(s). For the gain margin we ﬁnd ﬁrst the frequency where the phase of L(jω) is −180◦. We then ﬁnd |L(jω)| at this frequency. For the phase margin ﬁnd ﬁrst the frequency where |L(jω)| = 1. We then ﬁnd the phase of L(jω) at this frequency and how much it devi- ates from −180◦. 14 6.5 Performance of feedback systems Good feedback properties ⇐⇒ “Small” sensitivity \f \f \f \f 1 The slide on the left shows that a small mag- nitude in the frequency response of the sensitiv- ity function S(s) = 1 1 + L(s) leads to good closed- loop properties. In particular, it leads to a rejection of output disturbances as the sensitivity S(s) is the closed-loop transfer function from ¯d to ¯y. It also reduces the eﬀect of parameter uncer- tainty (second point in the slide). 15 6.5.1 The relationship between open and closed-loop frequency responses Ultimately what we are always interested in are properties of the closed-loop system, such as its frequency response and pole locations. The following plots are representative of a typical feedback system, and correspond to a feedback system with a Return Ratio of L(s) = 2 16 Nyquist diagram of the return ratio L(s) = 2 17 Small gain and/or phase margins correspond to there being frequencies at which L(jω) comes close to the −1. We now see that this also corresponds to making |1 + L(jω)| small and hence there being resonant peaks in the closed-loop transfer functions. So, Small gain and/or phase margins are bad for robustness, and bad for performance. 18 6.6 The Nyquist stability theorem (for asymptotically stable L(s)) On page 12 we gave an informal statement of the Nyquist stability criterion. The formal statement of the Nyquist stability theorem requires counting encirclements of the point −1: As before, we take L(s) to be the return ratio so that the closed-loop characteristic equation is 1 + L(s) = 0. We make the following simplifying assumption: L(s) is asymptotically stable This also guarantees that L(jω) is ﬁnite for all ω ( i.e. it has no jω-axis poles), and that L(∞) is ﬁnite (since L(s) must be proper – see Handout 4). Under this condition the “full” Nyquist diagram of L(jω), for −∞ < ω < +∞, is a closed curve (since L(j∞) = L(−j∞) = L(∞)). Note that, since (−jω) = (jω)∗, it follows that L(−jω) = L(jω)∗. So the section of the Nyquist locus for ω < 0 is the reﬂection in the real axis of the section for ω > 0. With this assumption we have: The Nyquist Stability Theorem (for stable L(s)) Consider a feedback system with an asymptotically stable return ratio L(s). In this case, the feedback system is asymptotically stable (i.e. L(s) 19 6.6.1 Notes on the Nyquist Stability Theorem: 1. Encirclements must be ‘added algebraically’. If there is 1 clockwise and 1 anticlockwise encirclement then they ‘add up’ to 0 encirclements. 2. L(s) often has one or more poles at 0 (due to integrators in the plant or the controller). The theorem still works, but one has to worry about what happens to the graph of L(jω) at ω = 0 (as the locus is no longer a closed curve). It can be shown that, if L(s) has n poles at the origin, then the Nyquist locus should be completed by adding a large n × 180◦ arc, in a clockwise direction. 3. If L(s) is unstable, and has np unstable poles, then the theorem must be modiﬁed as follows: “The feedback system is stable if and only if the ‘full’ Nyquist diagram makes np anticlockwise encirclements of the point (−1 + 0j).” 4. (This is a repeat of the informal statement of the Nyquist stability criterion from page 12.) A potentially ambiguous statement of the theorem, but one which almost always works, is: “The feedback system is stable if the Nyquist diagram of L(jω) ‘leaves the point −1 + j0 on its left’ ”. This still works (usually) if there are poles at the origin or even if L(s) is unstable. This informal version of the theorem is adequate for the examples which follow, for any others that you will encounter on this course and indeed for any you are likely to encounter in practice. 20 The points mentioned on the left will be illus- trated via examples in the next two pages. 20 Examples: Formal application of Nyquist stability theorem. ℜ ℑ −1 no encirlements of −1 =⇒ L(s) The solid black line shows the Nyquist di- agram for positive fre- quencies and the green dashed line shows the diagram for negative frequencies. The arrow illustrates the direction of the plot as the fre- quency increases. In the fourth example there is a pole at the ori- gin and hence the mag- nitude in the Nyquist diagram tends to ∞ as ω → 0. It should be noted that here we have applied the sec- ond point in the previ- ous page; i.e. an arc was drawn in a clockwise direction (dotted line) to complete the Nyquist diagram. 21 Examples: Informal application of the Nyquist stability theorem (based on note 4). ℜ ℑ −1 -1 to left of locus =⇒ L(s) The diagrams on the left illustrate that the informal statement of the Nyquist stability criterion is also valid for the examples that have been considered. 22","libVersion":"0.2.4","langs":""}