{"path":"P7 - Maths/_handouts/Linalg 4.pdf","text":"1 IB Paper 7: Linear Algebra Handout 4 3.7 Bases for the Column Space and Row Space of A LU decomposition gives us an immediate answer to how to generate convenient descriptions for the Row Space and Column Space of A. For a general m × n matrix Column Space = all vectors formed by taking a linear combination of the columns of A 11 2 2 3 3 ... nnaa a aλ λλ λ++ + + as the λ’s vary. Row Space = all vectors formed by taking a linear combination of the rows of A 12 312 3 ... m maa a aμ μμ μ++ + +%% % % as the μ’s vary. We shall use the matrix A on which we performed LU decomposition in section 3.3 denoted AI AI = 12 1 3 26 3 12 12 2 8 ⎡⎤ ⎢⎥ ⎢⎥ ⎢⎥−⎣⎦ = 10 0 21 0 12 1 ⎡ ⎤ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥−⎣ ⎦ 12 1 3 02 1 6 00 1 1 ⎡ ⎤ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥−⎣ ⎦ = LUI and in order to show the range of behaviour, AII = 12 1 3 26 3 12 12 1 9 ⎡⎤ ⎢⎥ ⎢⎥ ⎢⎥−⎣⎦ = 10 0 21 0 12 1 ⎡ ⎤ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥−⎣ ⎦ 12 1 3 02 1 6 0000 ⎡ ⎤ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥⎣ ⎦ = LUII You will see that, since it is only the bottom right-hand corner of A that is different, it is only the last row of U that changes and L is the same for both. You should check this by either LU or by simply multiplying out. Now in terms of the outer products of the columns and rows of L and UI and UII, TT T 11 2 2 3 3lu l u l u=+ +IA %% % TT T 11 2 2 3 3lu l u l u=+ +IIA %% % Basis for Column Space Remembering that we can consider matrix multiplication as a relationship between columns (see section 2.6) [ ] [ ] [ ]11 21 31 11 2 3 uu u al l l ⎡⎤ ⎡ ⎤ ⎡ ⎤ ⎡ ⎤↑↑ ↑ ↑ ⎢⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥ =+ +⎢⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥↓↓ ↓ ↓⎣⎦ ⎣ ⎦ ⎣ ⎦ ⎣ ⎦ , i.e. 11 21 3111 2 3au l u l u l= ++ , etc. 2 Since all of the columns of A can be written in terms of them, this means that l1 , l2 , … form a basis for the column space of A (at least the set of them for which the corresponding u% is non-zero do). We see immediately that for matrix AI 11al= 21 222al l= + 31 2 33al l l= ++ 41 2 336al l l=+ − while for matrix AII 11al= 21 222al l= + 31 23al l= + 41 236al l= + Since the columns of L are independent (see next section), a basis of the column space of AI is 10 0 2 , 1 and 0 12 1 ⎡⎤ ⎡ ⎤ ⎡ ⎤ ⎢⎥ ⎢ ⎥ ⎢ ⎥ ⎢⎥ ⎢ ⎥ ⎢ ⎥ ⎢⎥ ⎢ ⎥ ⎢ ⎥−⎣⎦ ⎣ ⎦ ⎣ ⎦ while one for AII is 10 2 and 1 12 ⎡⎤ ⎡ ⎤ ⎢⎥ ⎢ ⎥ ⎢⎥ ⎢ ⎥ ⎢⎥ ⎢ ⎥−⎣⎦ ⎣ ⎦ Basis for Row Space Remembering that we can also consider matrix multiplication as a relationship between rows (see section 2.7) [ ] [ ] [ ]11 12 1311 2 3ab c b cb c←→ = ← → + ← → + ← →⎡ ⎤⎡⎤ ⎡ ⎤ ⎡ ⎤⎣⎦ ⎣ ⎦ ⎣ ⎦ ⎣ ⎦%% % % , i.e. 11 12 1311 2 3al u l u l u=+ +%% % % , etc. we see immediately that for matrix AI 11au=%% 21 22au u= +%% % 31 2 32au u u= −+ +%% % % while for matrix AII 11au=%% 21 22au u= +%% % 31 2 32au u u= −+ +%% % % A basis of the row space of AI is 10 0 22 0 , and 11 1 36 1 ⎡⎤ ⎡⎤ ⎡ ⎤ ⎢⎥ ⎢⎥ ⎢ ⎥ ⎢⎥ ⎢⎥ ⎢ ⎥ ⎢⎥ ⎢⎥ ⎢ ⎥ ⎢⎥ ⎢⎥ ⎢ ⎥ −⎣⎦ ⎣⎦ ⎣ ⎦ while AII is 10 22 and 11 36 ⎡⎤ ⎡⎤ ⎢⎥ ⎢⎥ ⎢⎥ ⎢⎥ ⎢⎥ ⎢⎥ ⎢⎥ ⎢⎥ ⎣⎦ ⎣⎦ 3 Notice that, in passing, we seem to have proved a rather remarkable theorem. The dimension of column space is equal to the columns of L that correspond to non-zero rows of U. The dimension of row space is also equal to the number of non-zero rows of U. For a general matrix A, TT T T 11 2 2 3 3 mmlu l u l u l u=+ + + +A ...%% % % and, if we throw away the zero terms TT T T 11 2 2 3 3 rrlu l u l u l u=+ + + +A ...%% % % i.e. for any matrix number of independent rows = number of independent columns The number of independent columns, you will remember, is something we called the rank of A. 3.8 Properties of the L & U matrices Now, it might be obvious that the columns of L and the non-zero rows of U are independent. We could check this by assuming the opposite: that the columns of L are not independent, then we should be able to write one of them as a linear combination of the other two. This would mean 12 3 0ll lα βγ++ = i.e. 10 0 1 0 0 0 21 0 2 1 0 0 12 1 1 2 1 0 α αβ γ β γ ⎡⎤ ⎡ ⎤ ⎡ ⎤ ⎡ ⎤ ⎡ ⎤ ⎡ ⎤ ⎢⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥++ = =⎢⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥−−⎣⎦ ⎣ ⎦ ⎣ ⎦ ⎣ ⎦ ⎣ ⎦ ⎣ ⎦ and solving these by forward substitution gives α = β = γ = 0, i.e. we can never write one as a linear combination of the other two, which is the definition of independence. The decomposition A = LU will always produce a square matrix like L = 10 0 21 0 12 1 ⎡⎤ ⎢⎥ ⎢⎥ ⎢⎥−⎣⎦ with 0’s above the diagonal and 1’s down the diagonal. It should be clear that the value of the determinant of a lower diagonal matrix is the product of the diagonal terms. For L, which always has 1's down the diagonal, det L = 1 . This means that L−1 exists, rank(L) = no of columns , etc. (N.B. det L ≠ 0, is another way of demonstrating the columns of L are independent) It should also be clear that, since the column space of L is the whole of Rm, that any vector in Rm can be expressed in terms of the columns of L. We have seen that the upper echelon matrix U is the same shape as A. U will be square only when A is. When it is square, it makes sense to talk about the determinant of U and whether U has an inverse. It should be clear from that U has an inverse if and only if A has one. ( U A −1L = L −1A A −1L = I) 4 4. The Solution of Ax = b 4.1 What are we expecting ? We know that for a 3 × 3 matrix A Equations independent ? No Yes No SolutionEquations compatible ? Unique solution No x = x0 + λt Yes A x = b For a general m × n case, as for example the matrix associated with the structure analysed in section 1 of Handout 1, tf=A I EII EIII IV F V F VI 00 0 1 1/ 2 0 0 10 0 0 1/ 2 0 0 00 1/2 0 1 0 1/2 0 1/2 1 0 0 1/2 x y x y t ft ft t f t f W t ⎡⎤ ⎡⎤⎢⎥− ⎡⎤ ⎡⎤ ⎢⎥⎢⎥ ⎢⎥ ⎢⎥−−⎢⎥⎢⎥ ⎢⎥== ⎢⎥ ⎢⎥⎢⎥ ⎢⎥− ⎢⎥ ⎢⎥⎢⎥ ⎢⎥ −⎢⎥⎣⎦−− ⎣⎦⎢⎥⎢⎥⎣⎦ ⎣⎦ we will amend this to Yes No Solution Equations compatible ? i.e. b in column space of A ? No A x = b Yes x = x0 + λ n1 + μ n2 + ... and the issues are now (i) how to tell if b is in the column space of A and (ii) how do we find x0 , n1, n2, ... (and how many of them should there be). We don’t really need to consider the case of a unique solution as special; this will come out in the wash as there being zero n’s. 5 4.2 How do we check whether b is in Column Space ? The answer to (i) is that we when we express b in terms of the columns of L, it should only need those columns that are in the column space of A. AI = 12 1 3 26 3 12 12 2 8 ⎡⎤ ⎢⎥ ⎢⎥ ⎢⎥−⎣⎦ = 10 0 21 0 12 1 ⎡⎤ ⎢⎥ ⎢⎥ ⎢⎥−⎣⎦ 12 1 3 02 1 6 00 1 1 ⎡ ⎤ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥−⎣ ⎦ = L UI Col Space 10 0 2, 1 and 0 12 1 ⎡⎤ ⎡ ⎤ ⎡ ⎤ ⎢⎥ ⎢ ⎥ ⎢ ⎥ ⎢⎥ ⎢ ⎥ ⎢ ⎥ ⎢⎥ ⎢ ⎥ ⎢ ⎥−⎣⎦ ⎣ ⎦ ⎣ ⎦ AII = 12 1 3 26 3 12 12 1 9 ⎡⎤ ⎢⎥ ⎢⎥ ⎢⎥−⎣⎦ = 10 0 21 0 12 1 ⎡⎤ ⎢⎥ ⎢⎥ ⎢⎥−⎣⎦ 12 1 3 02 1 6 0000 ⎡ ⎤ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥⎣ ⎦ = L UII Col Space 10 2 and 1 12 ⎡⎤ ⎡ ⎤ ⎢⎥ ⎢ ⎥ ⎢⎥ ⎢ ⎥ ⎢⎥ ⎢ ⎥−⎣⎦ ⎣ ⎦ When we solve Ax = b using LU decomposition, LUx = b , then, we recast the problem as Lc = b and Ux = c. The first step is to find c this is expressing b in terms of the columns of L. 1 12 3 2 3 10 0 1 0 0 1 21 0 2 1 0 4 12 1 1 2 1 2 c cc c c c ⎡⎤⎡⎤ ⎡ ⎤ ⎡ ⎤ ⎡ ⎤ ⎡ ⎤ ⎢⎥⎢⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥++ = =⎢⎥⎢⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢⎥⎢⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥−−⎣⎦ ⎣ ⎦ ⎣ ⎦ ⎣ ⎦ ⎣ ⎦⎣⎦ 11 =c 224 12 =−= cc 122 213 −=−+= ccc ⇒ c = ⎥ ⎥ ⎥ ⎦ ⎤ ⎢ ⎢ ⎢ ⎣ ⎡ − = ⎥ ⎥ ⎥ ⎦ ⎤ ⎢ ⎢ ⎢ ⎣ ⎡ 1 2 1 3 2 1 c c c There will be a solution for AI but not for AII. 4.3 Completing the Solution Ux = c (finding the Null-Space of A) As part of the following procedure, we will be generating n1, n2 , ... which will be the general solution of An = 0. We are, in effect, generating a basis for the null space of A CASE I Ux = c ⇒ ⎥ ⎥ ⎥ ⎦ ⎤ ⎢ ⎢ ⎢ ⎣ ⎡ − = ⎥ ⎥ ⎥ ⎥ ⎦ ⎤ ⎢ ⎢ ⎢ ⎢ ⎣ ⎡ ⎥ ⎥ ⎥ ⎦ ⎤ ⎢ ⎢ ⎢ ⎣ ⎡ − 1 2 1 1100 6120 3121 t z y x Starting with the last of these and working upwards 1zt− =− This is the first evidence of the problem being under-determined. We can not solve this equation. We will, instead use it to find z in terms of t. 6 1zt= −+ We can now go on to solve for the other variables in terms of t, by back substitution. ()22 6 2 1 6yz t t t=− − = − − + − ⇒ 37 22 yt=− and 12 3x yz t=− − − 13 7 1 3tt t=− + + − − ⇒ 13x t=−+ In vector form this means the solution satisfies 13 3/ 2 7 / 2 11 01 x y t z t ⎡⎤ ⎡ ⎤ ⎡ ⎤ ⎢⎥ ⎢ ⎥ ⎢ ⎥ ⎢⎥ ⎢ ⎥ ⎢ ⎥=+ ⎢⎥ ⎢ ⎥ ⎢ ⎥ ⎢⎥ ⎢ ⎥ ⎢ ⎥ ⎣⎦ ⎣ ⎦ ⎣ ⎦ − − − 0x xt n= + i.e. a line of solutions where t can take any value. The variables x, y and z , which have (non-zero) pivots are called basic variables, while t is a free variable. The choice of which variable to take as the free one is a bit arbitrary, we could have regarded z as being free, rather than t. We have followed a convention. The variables with pivots are the basic variables; the variables without pivots are the free ones. Check: 13 12 1 3 12 1 3 12 1 3 3/ 2 7 / 2 26 3 12 2 6 3 12 26 3 12 11 12 2 8 12 2 8 12 2 8 01 x y t z t −⎡ ⎤⎡ ⎤ ⎡ ⎤ ⎡⎤ ⎡⎤⎡⎤⎢ ⎥⎢ ⎥ ⎢ ⎥−⎢⎥ ⎢⎥⎢⎥=+⎢ ⎥⎢ ⎥ ⎢ ⎥ −⎢⎥ ⎢⎥⎢⎥⎢ ⎥⎢ ⎥ ⎢ ⎥−− −⎣⎦ ⎣⎦⎣⎦⎢ ⎥⎢ ⎥ ⎢ ⎥⎣ ⎦⎣ ⎦ ⎣ ⎦ = 13 1 3 7 1 3 1 0 29 3 6 21 3 12 4 0 13 2 3 7 2 8 2 0 tt −+ − − + +⎡⎤ ⎡ ⎤ ⎡ ⎤ ⎡ ⎤ ⎢⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥−+ − + − + + = +⎢⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥+− − − + +⎣⎦ ⎣ ⎦ ⎣ ⎦ ⎣ ⎦ We refer to 0x xt n=+ as the general solution. The first vector is a particular solution, while the rest is the solution of A x = 0. Since L is always invertible, we see immediately that xx x⇔ =⇔= =LU 0 UA0 0 (because L−1 exists) so that the Null Space of A is the same as the Null Space of U (which is easier to find). 7 We can also approach this problem using a “a particular solution” plus “general solution of Ax = 0” method. This would be (taken from the Maths Databook) 1. Set the free variable to zero and find a particular solution x0 2. Set the RHS to zero (i.e.Ux = 0), put the free variable equal to the value 1 and solve to find n. There may actually be more than one free variable, when this becomes 1. Set all free variables to zero and find a particular solution x0 . 2. Set the RHS to zero, give each free variable in turn the value 1 while the others are zero, and solve to find a set of vectors which span the nullspace of A. CASE II Ux = c ⇒ 12 1 3 1 02 1 6 2 0000 1 x y z t ⎡⎤ ⎡ ⎤⎡ ⎤⎢⎥ ⎢ ⎥⎢ ⎥⎢⎥=⎢ ⎥⎢ ⎥⎢⎥ ⎢ ⎥⎢ ⎥−⎢⎥⎣ ⎦⎣ ⎦ ⎣⎦ As noted earlier, we can not solve this, unless c3 = 0. If b, on the other hand, had been 1 4 3 ⎡⎤ ⎢⎥ ⎢⎥ ⎢⎥⎣⎦ , then Lc = b gives 1 2 3 10 0 1 21 0 4 12 1 3 c c c ⎡⎤⎡⎤ ⎡ ⎤ ⎢⎥⎢⎥ ⎢ ⎥=⎢⎥⎢⎥ ⎢ ⎥ ⎢⎥⎢⎥ ⎢ ⎥−⎣⎦ ⎣ ⎦⎣⎦ ⇒ c = 1 2 3 1 2 0 c c c ⎡⎤⎡⎤ ⎢⎥⎢⎥=⎢⎥⎢⎥ ⎢⎥⎢⎥⎣⎦⎣⎦ and the equations are compatible. Ux = c, is now 12 1 3 02 1 6 0000 1 2 0 x y z t ⎡⎤ ⎢⎥⎡⎤ ⎢⎥⎢⎥ ⎢⎥⎢⎥ = ⎢⎥ ⎡ ⎢⎥ ⎢⎥⎢⎥⎣⎦ ⎢ ⎤ ⎢⎥ ⎢⎥ ⎢⎥ ⎢ ⎥ ⎣⎦ ⎣⎦ ⎥ Only x and y have pivots and this time both z and t are free variables. 1. To find x0 , set the free variables to zero. This gives (using back substitution) 2 y = 2 ⇒ y = 1 and x = 1 − 2 y ⇒ x = −1 i.e. 2. Set the RHS to zero, give each free variable in turn the value 1 while the others are zero, and solve to find a set of vectors which span the nullspace of A. 0 1 1 0 0 x −⎡ ⎤ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎣ ⎦ = 8 Put t = 1, z = 0 12 1 3 0 02 16 0 0 000 0 0 1 x y ⎡⎤ ⎢⎥⎡⎤ ⎡ ⎤ ⎢⎥⎢⎥ ⎢ ⎥ ⎢⎥⎢⎥ ⎢ ⎥= ⎢⎥⎢⎥ ⎢ ⎥ ⎢⎥⎢⎥ ⎢ ⎥⎣⎦ ⎣ ⎦ ⎢⎥⎣⎦ By back substitution, 2 y = −6 ⇒ y = −3 and x = −3 − 2 y = 3 i.e. Put t = 0, z = 1 12 1 3 0 02 16 0 1 000 0 0 0 x y ⎡⎤ ⎢⎥⎡⎤ ⎡ ⎤ ⎢⎥⎢⎥ ⎢ ⎥ ⎢⎥⎢⎥ ⎢ ⎥= ⎢⎥⎢⎥ ⎢ ⎥ ⎢⎥⎢⎥ ⎢ ⎥⎣⎦ ⎣ ⎦ ⎢⎥⎣⎦ By back substitution, 2 y = −1 ⇒ y = − 1 2 and x = −1 − 2 y = x = 0 The general solution is, therefore, 0 13 1 13 2 00 1 01 0 tzx ⎡ ⎤ −⎡⎤ ⎡ ⎤ ⎢ ⎥ ⎢⎥ ⎢ ⎥ ⎢ ⎥− −⎢⎥ ⎢ ⎥++ ⎢ ⎥ ⎢⎥ ⎢ ⎥ ⎢ ⎥ ⎢⎥ ⎢ ⎥ ⎢ ⎥⎣⎦ ⎣ ⎦ ⎣ ⎦ = ⎢ ⎥ You can now do Examples Paper 1 Question 8. 1 3 3 0 1 n ⎡ ⎤ ⎢ = ⎥−⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎣ ⎦ 2 0 1 2 1 0 i.e. n ⎡ ⎤ ⎢ = ⎥ ⎢ ⎥− ⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥⎣ ⎦ 9 Key Points from Lecture A x = b A = LU Solve L c = b Consider U x = c Yes No Yes No Rows of U = 0 ? Compatible ? Same c’s = 0 G. Solution x = x0 + λn1 + μn2 + ... No Solution 1. Set all free variables to zero and find a particular solution x0 . 2. Set the RHS to zero, give each free variable in turn the value 1 while the others are zero, and solve to find a set of vectors which span the nullspace of A. Basis for Column Space The first r columns of L are a convenient basis for column space where r = no of non-zero rows of U Basis for Null Space of A Generate by Note 2 above. Basis for Row Space of A The non-zero rows of U.","libVersion":"0.2.4","langs":""}