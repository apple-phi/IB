{"path":"P6 - Information/_handouts/Signal analysis.pdf","text":"Sampling DTFT Nyquist Ideal reconstruction IB Paper 6: Signal and Data Analysis Handout 5: Sampling Theory S Godsill Signal Processing and Communications Group, Engineering Department, Cambridge, UK Lent 2023 1 / 27 Sampling DTFT Nyquist Ideal reconstruction Sampling and Aliasing • All of our work so far with Fourier series and Fourier transforms has worked with signals and functions in continuous time. • Calculation of Fourier coeﬀicients requires integrals over continuous time. • This is fine when you consider special functions whose formula can be written down (sine, cosine, δ-function, etc.) 2 / 27 Sampling DTFT Nyquist Ideal reconstruction • However, in the real world, signals don’t have a pre-specified formula - we just have to measure them. • Nowadays, signals are measured in digital form on computers, which means discrete time sampling, or analogue to digital conversion. • Can we still do signal analysis when continuous time signals have been sampled and stored in digital format? • The theory of sampling and aliasing shows how to do this in a proper fashion. 3 / 27 Sampling DTFT Nyquist Ideal reconstruction Digital Sampling −1.5 −1 −0.5 0 0.5 1 1.5 T 2T 3T 4T 5T 6T 7T 8T 9T f(t) f(T) f(2T) f(3T) f(4T) Figure 1: Digital sampling of a continuous waveform 4 / 27 Sampling DTFT Nyquist Ideal reconstruction Firstly define what is meant by Digital sampling: • Suppose a continuous time signal is given by f(t), −∞ < t < +∞ • Choose a sampling interval T and read off the value of f(t) at times: −∞, ... − 2T, −T, 0, T, 2T, ..., +∞ i.e. at times nT, n = −∞, ..., −1, 0, 1, 2, ..., ∞. • The obtained values f(nT) are the sampled version of f(t). • The practical procedure, known as analogue to digital conversion, is discussed further in the Communications course (P6 2nd half of Lent term). 5 / 27 Sampling DTFT Nyquist Ideal reconstruction The big question is: how should you choose T, the sampling interval? • Too large a value of T will mean loss of detail from f(t):0 5 10 15 20 25 30 −1 −0.5 0 0.5 1 0 5 10 15 20 25 30 −1 −0.5 0 0.5 1 Figure 2: Sparse sampling of a continuous waveform 6 / 27 Sampling DTFT Nyquist Ideal reconstruction • Too small a value means unnecessary storage of over-detailed (redundant) data: 0 5 10 15 20 25 30 −1 −0.5 0 0.5 1 0 5 10 15 20 25 30 −1 −0.5 0 0.5 1 Figure 3: Dense sampling of a continuous waveform 7 / 27 Sampling DTFT Nyquist Ideal reconstruction • We need the ‘Goldilocks’ principle! ‘Not too big; and not too small; but just right’ But, seriously: • The Sampling Theorem tells us the maximum value of T we can take and still perfectly reconstruct f(t) from f(nT) - a remarkable and perhaps not obvious result. 8 / 27 Sampling DTFT Nyquist Ideal reconstruction The Sampling Theorem −1.5 −1 −0.5 0 0.5 1 1.5 −1.5 −1 −0.5 0 0.5 1 1.5 Figure 4: Representing the sampled data as a train of δ-functions 9 / 27 Sampling DTFT Nyquist Ideal reconstruction Firstly define a mathematical representation of the sampled signal using a train of δ-functions: Do this by taking each sample f(nT) and multiplying it by a δ-function centered at t = nT: f(nT)δ(t − nT) But this equals f(t)δ(t − nT) [since δ(t − nT) is zero except at t = nT] Then sum all such samples to give the whole sampled signal as: fs(t) = ∞ ∑ n=−∞ f(t)δ(t − nT) = f(t) ∞ ∑ n=−∞ δ(t − nT) = f(t) δp(t) 10 / 27 Sampling DTFT Nyquist Ideal reconstruction fs(t) is then a continuous time signal which contains only the sampled data information f(nT) - it is zero elsewhere. Note: think of this as an conceptual version of the sampled signal – in no way are we implying that there are infinities in a real sampled signal. 0 T 2T 3T 4T 5T 6T 7T 8T 9T 10T 0 δ p(t) Figure 5: Train of delta functions, δp(t) 11 / 27 Sampling DTFT Nyquist Ideal reconstruction δp(t) is a periodic function and can therefore be represented as a Fourier series: δp(t) = ∞ ∑ n=−∞ cne jnω0t (1) where ω0 = 2π/T and the cn are given by cn = 1 T ∫ T/2 −T/2 δp(t)e−jnω0tdt = 1 T for all n (2) (This is also a question on example sheet 6/6). We therefore have an alternative formula for the sampled signal: fs(t) = f(t) δp(t) = f(t) 1 T ∞ ∑ n=−∞ ejnω0t (3) = 1 T ∞ ∑ n=−∞ f(t) ejnω0t (4) 12 / 27 Sampling DTFT Nyquist Ideal reconstruction It turns out that this formula is much easier to understand in the frequency domain. We will therefore determine the Fourier Transform of fs(t). Looking at each term of the summation, we have from the frequency shift theorem: f(t)ejnω0t FT ←→ F(ω − nω0) (5) Hence the Fourier transform of the sum is (by linearity): Fs(ω) = 1 T ∞ ∑ n=−∞ F(ω − nω0) (6) 13 / 27 Sampling DTFT Nyquist Ideal reconstruction i.e. The Fourier transform of the sampled signal is simply 1/T times the Fourier transform of the continuous signal repeated every integer multiple of the sampling frequency and summed together. Example: −3 −2 −1 0 1 2 3 4 5 −0.4 −0.2 0 0.2 0.4 0.6 0.8 1 Figure 6: Spectrum repeated every integer multiple of the sampling frequency 14 / 27 Sampling DTFT Nyquist Ideal reconstruction We will see shortly that this fundamental result is all we need to answer the original question: what is the optimal sampling frequency 1/T for perfect reconstruction of the original signal f(t) from its samples f(nT)? 15 / 27 Sampling DTFT Nyquist Ideal reconstruction Discrete-time Fourier Transform As well as the above analysis, note that the Fourier transform of the sampled signal can also be written as follows: Fs(ω) = ∫ ∞ −∞ fs(t)e−jωtdt = ∫ ∞ −∞ { ∞ ∑ n=−∞ f(t)δ(t − nT) } e−jωtdt = ∞ ∑ n=−∞ {∫ ∞ −∞ f(t)e−jωtδ(t − nT)dt} = ∞ ∑ n=−∞ f(nT)e−jnωT [Using sifting property of δ] This alternative formula is known as the Discrete-Time Fourier Transform or DTFT. The DTFT shows how to calculate the frequency content of the ideal sampled signal directly from its sampled values f(nT). 16 / 27 Sampling DTFT Nyquist Ideal reconstruction Nyquist Frequency and Reconstruction We have seen that the spectrum (=Fourier Transform) of a sampled signal consists of many repetitions of the spectrum of the original signal f(t): Fs(ω) = 1 T ∞ ∑ n=−∞ F(ω − nω0) (7) Now, see Figure 7, which shows the sampled spectrum for a signal with bandwidth ωmax and for 3 possible values of the sampling frequency ω0 = 2π/T. 17 / 27 Sampling DTFT Nyquist Ideal reconstruction ω −8.5 0 ω ω F(ω) F(ω−ω 0) F(ω+ω 0) F(ω+2ω 0) F(ω+2ω 0) F(ω+ω 0) F(ω) F(ω) F(ω−ω 0) F(ω−ω 0) F(ω+ω 0) F(ω+2ω 0) . . . . . . . . . . . . . . . . . . (a) ω 0=4ω max (b) ω 0=2ω max (c) ω 0=1.5ω max 0 0 0 ω max −ω max H r(ω) H r(ω) 1 1 ω 0 −ω 0 ω 0 −ω 0 2ω 0 −2ω 0 ω 0 2ω 0 −ω 0 −2ω 0 F(ω−2ω 0) F(ω−2ω 0) F(ω−2ω 0) Figure 7: The sampled spectrum Fs(ω) for various values of sampling frequency 18 / 27 Sampling DTFT Nyquist Ideal reconstruction Now, attempt to extract just F(ω) from the sampled spectrum Fs(ω) • Apply a filter with frequency response Hr(ω) (shown dotted) to the sampled signal. • Since Y(ω) = Hr(ω)Fs(ω) we can see from the diagram that for cases (a) and (b), Y(ω) = F(ω) and we have reconstructed the original signal spectrum perfectly. In the third case (c), F(ω) is not properly reconstructed. • In general it is possible to reconstruct the original spectrum only when there is no overlap between the periodic repetitions of F(ω). 19 / 27 Sampling DTFT Nyquist Ideal reconstruction The Nyquist sampling theorem can now be stated as: If a signal f(t) has a maximum frequency content (or bandwidth) ωmax, then it is possible to reconstruct f(t) perfectly from its sampled version fs(t) provided the sampling frequency is at least ω0 = 2ωmax, the ‘Nyquist frequency’ 20 / 27 Sampling DTFT Nyquist Ideal reconstruction • The minimum sampling frequency of 2 × ωmax is known as the Nyquist Frequency, ωNyq. • The repetitions of F(ω) in the sampled spectrum are known as aliasing • When a signal is sampled at a rate less than ωNyq the distortion due to the overlapping spectra is called aliasing distortion 21 / 27 Sampling DTFT Nyquist Ideal reconstruction Ideal Reconstruction filter • The ideal filter frequency response for perfect reconstruction is the rectangle pulse function: Hr(ω) = {T, −ωmax < ω < +ωmax 0 otherwise • The impulse response of the filter is then the inverse Fourier transform of Hr(ω). We know that the inverse Fourier transform of a rectangular pulse is a sinc function, i.e. hr(t) = ωmaxT π sinc(ωmaxt) 22 / 27 Sampling DTFT Nyquist Ideal reconstruction Or, if we are sampling exactly at the Nyquist frequency, ωmax = ω0/2, and the above becomes hr(t) = ω0T 2π sinc(ω0t/2) = sinc(ω0t/2) Since multiplication in the frequency domain implies convolution in the time domain, the equivalent recovery operation back in the time domain becomes: f(t) = sinc(ω0t/2) ∗ fs(t) (8) By substituting fs(t) = ∑∞ n=−∞ f(nT)δ(t − nT) and performing the convolution, equation (8) becomes f(t) = ∫ ∞ −∞ fs(τ)sinc(ω0(t − τ)/2)dτ = ∫ ∞ −∞ { ∞ ∑ n=−∞ f(nT)δ(τ − nT) } sinc(ω0(t − τ)/2)dτ 23 / 27 Sampling DTFT Nyquist Ideal reconstruction Swapping order of integral and summation gives f(t) = ∞ ∑ n=−∞ f(nT) {∫ ∞ −∞ δ(τ − nT)sinc(ω0(t − τ)/2)dτ} (9) which can be evaluated using the sifting property as f(t) = ∞ ∑ −∞ f(nT)sinc [ π T (t − nT)] (10) This can be viewed as an exact interpolation formula for determining f(t) from its samples f(nT). 24 / 27 Sampling DTFT Nyquist Ideal reconstruction Practical considerations This is all very idealised. How would this be modified in practice? • Must determine the maximum frequency component ωmax present in a signal before sampling. • In order to eliminate the aliasing effects of high frequency noise or unwanted high signal frequencies, first filter the data with a low-pass filter having frequency response Hr(ω)/T, i.e. just a unity gain lowpass filter - call this filtered signal f(t) and proceed with sampling. • Then perform sampling at the Nyquist rate ω0 = ωNyq = 2 × ωmax to give digital samples f(nT). • Reconstruct the signal by passing the sampled signal through the same filter Hr(ω). 25 / 27 Sampling DTFT Nyquist Ideal reconstruction • In practice though we cannot exactly implement the ideal filter Hr(ω). Must therefore allow say 10% extra signal bandwidth for the transition band of the filters (see Paper 6 Commumications course) 26 / 27 Sampling DTFT Nyquist Ideal reconstruction Example: A music signal has bandwidth 20kHz. a) Determine the sampling period for this signal, assuming ideal filter responses. b) Determine a suitable sampling rate assuming a realistically achievable filter response. S. Godsill (2023 ), 27 / 27","libVersion":"0.2.4","langs":""}