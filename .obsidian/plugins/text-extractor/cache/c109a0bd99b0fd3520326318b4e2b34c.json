{"path":"P6 - Information/_handouts/Comms 5 (Passband modulation).pdf","text":"1B Paper 6: Communications Handout 5: Digital Passband Modulation Ramji Venkataramanan Signal Processing and Communications Lab Department of Engineering rv285@cam.ac.uk Lent Term 2024 1 / 22 Pulse Amplitude Modulation (recap) Recall that the PAM signal carrying the information symbols X1, X2, . . . is xb(t) = ∑ k Xk p(t − kT ) • xb(t) is a baseband signal (Recall: its bandwidth is the same as that of the pulse p(t)) • If the channel is a baseband channel, e.g., ethernet cable, we can directly transmit xb(t) But most channels are passband — we are only allowed to transmit our signal over a fixed frequency band centred around a carrier frequency fc . E.g., a wireless channel may have fc = 2 GHz and channel bandwidth = 10 MHz How do you “up-convert” the PAM signal to passband ? 2 / 22 Baseband to Passband The natural thing to do is to modulate the amplitude of a high-frequency carrier with xb(t): x(t) = xb(t) cos(2πfc t) = [ ∑ k Xk p(t − kT ) ] cos(2πfc t) x(t) y (t) n(t) • For lack of a standard name, we’ll call this passband modulation scheme up-converted PAM. • Note the similarity with analogue modulation (DSB-SC): here the information signal is a “digital” waveform, which is determined by the constellation symbols and a pulse. 3 / 22 Up-converted PAM with a rectangular pulse p(t) = { 1√T for t ∈ (0, T ] 0 otherwise is also called “Amplitude Shift Keying” (ASK). In this case, the transmitted passband waveform is x(t) = ∑ k Xk p(t − kT ) cos(2πfc t) = 1 √T Xk cos(2πfc t) for t ∈ [kT , (k + 1)T ) where Xk is chosen from a PAM constellation, say {−A, A}. Note that a rectangular pulse (and consequently, ASK) is not bandwidth efficient. (You may encounter the terminology ASK in past Tripos questions. You will not be examined on it, but recognise that it is just up-converted PAM with a rectangular pulse shape.) 4 / 22 Demodulation of up-converted PAM at the Rx First, down-convert via product modulator + low-pass filter × Low-pass ﬁlter [−W, W ] cos(2πfct) y(t) v(t) yb(t) yb(t) = xb(t) + nb(t) = ∑ k Xk p(t − kT ) + nb(t) where nb(t) is baseband noise. Next demodulate baseband waveform yb(t). We already know how to do this: pass yb(t) through matched filter, and then sample at times {mT }m∈Z h(t) = p(−t)Filteryb(t)r(t)t = mTr(mT ) 5 / 22 Detection • The sampled output of the matched filter at time mT is Ym = Xm + Nm where Nm = ∫ nb(τ )p(τ − mT ) dτ (see prev. handout for details) • Nm is Gaussian with zero mean and variance σ2 (σ2 can be empirically estimated) • Maximum-likelihood detection: Choose ˆXm to be the constellation symbol closest to Ym 6 / 22 Spectrum of up-converted PAM The transmitted waveform x(t) = xb(t) cos(2πfc t) has spectrum X (f ) = 1 2 [Xb(f − fc ) + Xb(f + fc )] Note that xb(t) = ∑ k Xk p(t − kT ) is a real signal since both the pulse p(t) and the symbols {Xk } are real-valued ⇒ Xb(−f ) = X ∗ b (f ) • The spectrum X (f ) for f ≥ 0 determines X (f ) for f < 0 −fc fc − W |X(f )| fc + W−fc + W−fc − W fc f 0 W−W |Xb(f )| Upper SidebandLower Sideband • Sending both sidebands is redundant, since all the information is contained in one 7 / 22 A bandwidth-efficient alternative to up-converted PAM • One way to save bandwidth is to send only one sideband, just like SSB-SC (see Amplitude Modulation handout) • But since we are transmitting digital information, there is a better way: make the information symbols complex-valued The baseband waveform is again xb(t) = ∑ k Xk p(t − kT ) but now the constellation from which the symbols Xk are drawn is complex-valued (i.e., Xk are now two-dimensional) xb(t) is now complex, but the passband signal we transmit has to be real. It is generated as x(t) = Re [ xb(t) ej2πfc t] = Re(xb(t))cos(2πfc t) − Im(xb(t))sin(2πfc t) This is called Quadrature Amplitude Modulation (QAM) 8 / 22 Quadrature Amplitude Modulation The upconverted QAM waveform that we transmit is x(t) = ∑ k p(t − kT ) [Re(Xk ) cos(2πfc t) − Im(Xk ) sin(2πfc t)] = ∑ k p(t − kT ) |Xk | cos(2πfc t + ϕk) where |Xk | and ϕk denote the magnitude and phase of the complex symbol Xk Thus, one can understand QAM in two ways: 1. QAM has two carriers, the cosine carries Re(Xk ) and the sin carries the Im(Xk ). 2. In QAM, the information symbol modulates both the amplitude and phase of the carrier; in up-converted PAM the information symbol is real and only modulates the amplitude • Pulse shape p(t) is the same as that for PAM • The main difference between QAM and PAM is the constellation. In PAM, Im(Xk ) = 0. 9 / 22 Some typical QAM Constellations −A A −A A −A A QPSKBPSK 8-PSK 16-QAM Re(Xk) Im(Xk)Im(Xk) Re(Xk) In “Phase Shift Keying” (PSK), the magnitude of Xk is constant, and the information is in the phase of the symbol. In a constellation with M symbols, each symbol corresponds to log2 M bits 10 / 22 Average Energy per Symbol −A A −A A QPSKBPSK −A A 8-PSK Im(Xk) Re(Xk) For all the PSK constellations, average symbol energy Es = A2 16-QAM d Im(Xk) Re(Xk) Average energy per symbol for 16-QAM Es = 40d 2 16 = 2.5d 2 Average energy per bit Eb = Es /log2 M 11 / 22 The transmitted waveform is x(t) = ∑ k p(t − kT ) [ X r k cos(2πfc t) − X i k sin(2πfc t)] where X r k := Re(Xk ) and X i k := Im(Xk ) x(t) y (t) n(t) • The energy per symbol is important because the power of x(t) ∝ Es T • At the Rx, we have to down-convert y (t) to a baseband waveform via product modulators and low-pass filter • For QAM, we need two product modulators, one for the cosine and the other for sine 12 / 22 At the receiver, we have y (t) = ∑ k p(t − kT ) [ X r k cos(2πfc t) − X i k sin(2πfc t)] + n(t) × Low-pass ﬁlter [−W, W ] cos(2πfct) y(t) yr(t) × Low-pass ﬁlter [−W, W ] − sin(2πfct) y(t) yi(t) After down-converting, we get y r (t) = ∑ k X r k p(t − kT ) + nr (t) y i (t) = ∑ k X i k p(t − kT ) + ni (t) where nr (t) and ni (t) are filtered (baseband) versions of n(t). Next perform matched-filter demodulation of y r (t) and y i (t) 13 / 22 Demodulation h(t) = p(−t) Filter yr(t) r(t) t = mT Y r m h(t) = p(−t) Filter yi(t) r(t) t = mT Y i m • The sampled outputs of the matched filters for m = 0, 1, . . . are: Y r m = X r m + N r m Y i m = X i m + N i m • It can be shown that N r m and N i m are each independent Gaussians distributed as N (0, σ2) for each m • For each m, we now have to detect the complex-valued constellation symbol Xm = (X r m, X i m) from Ym = (Y r m, Y i m) 14 / 22 Detection The discrete-time channel is Y = X + N where X , Y , N are now two-dimensional vectors, i.e., complex numbers with X = (X r , X i ) and Y = (Y r , Y i ) The optimal detection rule (assuming all constellation symbols are equally likely) is the maximum-likelihood detection rule ˆX = arg max x∈C f (Y |x) “Choose the symbol from which y is most likely to have occurred” The conditional distribution of Y = (Y r , Y i ) given x = (x r , x i ) is f (Y |x) = 1√2πσ2 e−(Y r −x r )2/2σ2 1√2πσ2 e−(Y i −x i )2/2σ2 = 1 2πσ2 e−[(Y r −x r )2+(Y i −x i )2]/2σ2 15 / 22 The optimal detector is therefore ˆX = arg min x∈C (Y r − x r ) 2 + (Y i − x i ) 2 = arg min x∈C |Y − x| 2 Choose the constellation symbol x closest to observed output Y (Same detection principle as PAM, but the symbols are complex in QAM) Example 1: The decision regions for QPSK A p2p3 p4 p1 ˆX = p1 Im(Y ) Re(Y ) 16 / 22 ˆX = arg min x∈C |Y − x| 2 Example 2: The decision regions for 8-PSK A p1 p2 p3 p4 p5 p6 p7 p8 ˆX = p1 Im(Y ) Re(Y ) • Can similarly sketch the decision regions for other constellations • We can also calculate the probability of detection error Pe = P( ˆX ̸= X ) for various constellations 17 / 22 −A A 8-PSK Im(Xk) Re(Xk) 16-QAM d Im(Xk) Re(Xk) d We won’t do an exact calculation of QAM probability of error Pe, but can be shown that: • Pe is a Q−function depending on d σ , where d is the separation between adjacent constellation points and σ2 is the variance of the Gaussian noise • Pe decays exponentially with d 2/σ2 Suppose we increase the number of constellation points, e.g., 16 QAM → 64 QAM → 256 QAM, while keeping Es constant (Es = average energy per symbol) : • Transmission rate increases: 4 bits/symbol → 6 bits/sym. → 8 bits/sym. (good!) • To keep Es constant, d has to decrease ⇒ Pe increases (bad!) 18 / 22 Note that both up-converted PAM and QAM are essentially amplitude modulation for digital information: • The (baseband) information signal xb(t) is generated from bits via a constellation as xb(t) = ∑ k Xk p(t − kT ). • The real and imaginary parts of xb(t) modulate the amplitude of the carriers cos(2πfc t) and sin(2πfc t), respectively. One can also transmit digital information by modulating the phase/frequency of a carrier. • Frequency shift keying (FSK) is one such method • Binary FSK: In each symbol time [kT , (k + 1)T ), transmit one bit Xk via x(t) = { cos(2π(fc − ∆f )t) if Xk = 0, cos(2π(fc + ∆f )t) if Xk = 1. 19 / 22 Example of binary FSK waveform for information bits 1 0 1 0 1 . . . (Image source: Wikipedia) 20 / 22 Quadrature Amplitude Modulation - The Key Points 10110100 QAM Modulator + x(t) QAM Demodulator y (t) 10100100 n(t) QAM is a technique to convert bits to a passband waveform: 1. QAM constellations are complex in general 2. Thus the baseband waveform is also complex xb(t) = ∑k Xk p(t − kT ) 3. We then up-convert and transmit a real passband waveform: x(t) = Re [xb(t) ej2πfc t] = ∑ k p(t − kT ) [Re(Xk) cos(2πfc t) − Im(Xk) sin(2πfc t)] 21 / 22 At the receiver: • Down-convert using product modulator + low-pass filter (separately for the sine, cosine carriers) • Demodulate the baseband waveforms using matched filter • Detection rule: Pick the constellation symbol closest to the (complex) output symbol Properties of the QAM signal: • Rate = 1/T QAM symbols/s or log2 M T bits/s, where M is the constellation size • Passband bandwidth of QAM waveform = 2W , where W is the bandwidth of the (baseband) pulse p(t) • Note that up-converted PAM also has the same bandwidth 2W . QAM is a very widely used modulation scheme. E.g., 4G LTE uses QPSK/16-QAM/64-QAM, also used in optical fibre communication You can now do Questions 1–5 in Examples Paper 9 22 / 22","libVersion":"0.2.4","langs":""}